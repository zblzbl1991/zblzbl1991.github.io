<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://zblzbl1991.github.io</id>
    <title>Gridea</title>
    <updated>2021-08-25T04:19:31.305Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://zblzbl1991.github.io"/>
    <link rel="self" href="https://zblzbl1991.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://zblzbl1991.github.io/images/avatar.png</logo>
    <icon>https://zblzbl1991.github.io/favicon.ico</icon>
    <rights>All rights reserved 2021, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[è§£å†³ConditionOnBean(DataSource.class)çš„åŠ è½½é¡ºåºçš„é—®é¢˜]]></title>
        <id>https://zblzbl1991.github.io/post/jie-jue-conditiononbeandatasourceclassde-jia-zai-shun-xu-de-wen-ti/</id>
        <link href="https://zblzbl1991.github.io/post/jie-jue-conditiononbeandatasourceclassde-jia-zai-shun-xu-de-wen-ti/">
        </link>
        <updated>2021-08-25T03:32:12.000Z</updated>
        <content type="html"><![CDATA[<p>å‰ä¸¤å¤©ç¢°åˆ°ä¸ªé—®é¢˜,æœ¬æ¥æ˜¯æ‰“ç®—åˆ©ç”¨SpringBootçš„@ConditionOnBeanæ¥å¤„ç†å½“é…ç½®äº†æ•°æ®æºä½¿ç”¨ABean,æ²¡æœ‰å°±æ˜¯ç”¨BBean,å¯æ˜¯æˆ‘åœ¨é…ç½®è¡¨ä¸­çš„ConditionOnBean(DataSource.class)çš„æ—¶å€™,æç¤ºæˆ‘bean not found javax.sql.DataSource ,ç½‘ä¸Šæ‰¾äº†è›®ä¹…,éƒ½æ˜¯åªè¯´äº†BeanåŠ è½½é¡ºåº,ä½†æ˜¯æ²¡æœ‰è¯´å¦‚ä½•è§£å†³çš„.</p>
<p>ä»Šå¤©çœ‹åˆ°ä¸€ä¸ªè§£å†³æ–¹æ³•,åˆ©ç”¨SpringBootçš„Beanå»¶æœŸåŠ è½½å™¨  <code>DeferredImportSelector</code></p>
<p>å…·ä½“è§£å†³ä»£ç :</p>
<pre><code class="language-java">/** @author zhaobaolong
 * @date 2021/8/25 9:00
 * @description conditionå»¶æœŸé€‰æ‹©å™¨å®ç°
 */
public class ConditionDeferredImportSelector implements DeferredImportSelector {
    @Override
    public String[] selectImports(AnnotationMetadata annotationMetadata) {
        return new String[]{LogConfig.class.getName()};
    }
}
</code></pre>
<pre><code class="language-java"> /** @author zhaobaolong
 * @date 2021/8/23 15:50
 * @description æä¾›ä¸€ä¸ªåˆå§‹åŒ–é…ç½®çš„ç±»
 */
@Slf4j
public class LogConfig {
    private static final String APP_NAME =&quot;defaultLog&quot;;
    @Autowired
    private RedisTemplate&lt;String,Object&gt; redisTemplate;

    @Bean
    @ConditionalOnMissingBean(value = {JdbcTemplate.class})
    public JdbcTemplate jdbcTemplate(DataSource dataSource){
        log.info(&quot;åŠ è½½é»˜è®¤jdbcTemplate&quot;);
        return new JdbcTemplate(dataSource);
    }
    @Bean
    @ConditionalOnMissingBean(ILogProducer.class)
    public ILogProducer producer(){
        log.info(&quot;åŠ è½½é»˜è®¤Producer&quot;);
        RedisUtil redisUtil = new RedisUtil(redisTemplate, APP_NAME);
        return new DefaultLogProducerImpl(redisUtil);
    }
    @Bean
    @ConditionalOnMissingBean(ILogConsumer.class)
    public ILogConsumer consumer(ILogStorage storage){
        log.info(&quot;åŠ è½½é»˜è®¤Consumer&quot;);
        RedisUtil redisUtil = new RedisUtil(redisTemplate, APP_NAME);
        return new DefaultLogConsumerImpl(redisUtil,storage);
    }

    @Bean
    @ConditionalOnBean(value = {DataSource.class})
    @ConditionalOnMissingBean(ILogStorage.class)
    public ILogStorage jdbcStorage(  ){
        log.info(&quot;åŠ è½½jdbc storage&quot;);
        return new JDBCStorageHandler();
    }
    @Bean
    @ConditionalOnMissingBean(value = {ILogStorage.class})
    public ILogStorage storage(){
        log.info(&quot;åŠ è½½é»˜è®¤è¾“å‡ºæ§åˆ¶å°storage&quot;);
        return new DefaultLogStorageImpl();
    }



}
</code></pre>
<pre><code class="language-java"> /** å¼€å¯æ—¥å¿—
 *
 * @Author: wubin
 * @DATE: 2021/3/11 0011 ä¸‹åˆ 15:44
 */
@Target({ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Inherited
@Documented
@Import({LogRecordAspect.class, ConditionDeferredImportSelector.class, SecurityUtil.class})
public @interface EnableLog {
}
</code></pre>
<p>è¿™æ ·é…ç½®,åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±ä¼šå…ˆåŠ è½½é»˜è®¤Beanæ‰§è¡Œé¡ºåº,æ‰§è¡Œå®Œä¹‹å,å†åŠ è½½å»¶æœŸåçš„Bean</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å…³äºè§£å†³ApplicationListeneré‡å¤æ‰§è¡Œ]]></title>
        <id>https://zblzbl1991.github.io/post/guan-yu-jie-jue-applicationlistener-chong-fu-zhi-xing/</id>
        <link href="https://zblzbl1991.github.io/post/guan-yu-jie-jue-applicationlistener-chong-fu-zhi-xing/">
        </link>
        <updated>2021-08-25T03:28:05.000Z</updated>
        <content type="html"><![CDATA[<p>ç±»å®ç°ApplicationListenerä¹‹å,å†å®ç°ApplicationContextAware</p>
<p>æˆ‘æ˜¯å‚è€ƒDubboçš„æ–¹æ³•,å®ƒçš„å®ç°æ–¹å¼æ˜¯:</p>
<pre><code class="language-java">public abstract class OnceApplicationContextEventListener implements ApplicationListener, ApplicationContextAware {
    protected final Log log = LogFactory.getLog(this.getClass());
    private ApplicationContext applicationContext;

    public OnceApplicationContextEventListener() {
    }

    public OnceApplicationContextEventListener(ApplicationContext applicationContext) {
        this.setApplicationContext(applicationContext);
    }

    public final void onApplicationEvent(ApplicationEvent event) {
        if (this.isOriginalEventSource(event) &amp;&amp; event instanceof ApplicationContextEvent) {
            this.onApplicationContextEvent((ApplicationContextEvent)event);
        }

    }

    protected abstract void onApplicationContextEvent(ApplicationContextEvent var1);

    private boolean isOriginalEventSource(ApplicationEvent event) {
        boolean originalEventSource = ObjectUtils.nullSafeEquals(this.getApplicationContext(), event.getSource());
        if (!originalEventSource &amp;&amp; this.log.isDebugEnabled()) {
            this.log.debug(&quot;The source of event[&quot; + event.getSource() + &quot;] is not original!&quot;);
        }

        return originalEventSource;
    }

    public final void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }

    public ApplicationContext getApplicationContext() {
        //åˆ¤æ–­ä¸Šä¸‹æ–‡æ˜¯å¦åˆå§‹åŒ–,åªæœ‰æœªåˆå§‹åŒ–å‰æ‰æ‰§è¡Œ,è¿™æ ·å¯ä»¥é˜²æ­¢é‡å¤æ‰§è¡Œ onApplicationEvent
        if (this.applicationContext == null) {
            throw new NullPointerException(&quot;applicationContext must be not null, it has to invoke setApplicationContext(ApplicationContext) method first if &quot; + ClassUtils.getShortName(this.getClass()) + &quot; instance is not a Spring Bean&quot;);
        } else {
            return this.applicationContext;
        }
    }
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[dockerå®‰è£…skywalking]]></title>
        <id>https://zblzbl1991.github.io/post/docker-an-zhuang-skywalking/</id>
        <link href="https://zblzbl1991.github.io/post/docker-an-zhuang-skywalking/">
        </link>
        <updated>2021-08-25T03:27:02.000Z</updated>
        <content type="html"><![CDATA[<ol>
<li>
<h3 id="å®‰è£…elasticsearch">å®‰è£…elasticsearch</h3>
</li>
</ol>
<pre><code>docker run -d --name=es7 -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; elasticsearch:7.5.1
</code></pre>
<p>â€‹	ç„¶åå°†æ•°æ®å¤åˆ¶å‡ºæ¥å»ºç«‹ä¸€ä¸ªç›®å½•</p>
<pre><code class="language-docker">docker cp es7:/usr/share/elasticsearch/logs /data/elasticsearch/
docker rm -f es7
mkdir -p /data/elasticsearch
</code></pre>
<p>æ‰§è¡Œå®Œä¹‹åå†æ¬¡å¯åŠ¨</p>
<pre><code class="language-shell">docker run -d --name=es7 --restart=always -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; -e ES_JAVA_OPTS=&quot;-Xms512m -Xmx512m&quot; -v /data/elasticsearch/data:/usr/share/elasticsearch/data  -v /data/elasticsearch/logs:/usr/share/elasticsearch/logs  elasticsearch:7.5.1
</code></pre>
<p>è¿™é‡Œå¯èƒ½ä¼šæŠ¥é”™æƒé™ä¸è¶³,é‚£ä¹ˆè¿™ä¸ªæ—¶å€™éœ€è¦å¯¹ä¸Šä¸ªæ“ä½œå»ºç«‹çš„ç›®å½•è¿›è¡Œæˆæƒæ“ä½œ</p>
<pre><code class="language-shell">sudo chmod 777 -R /data/elasticsearch
</code></pre>
<p>ç„¶åå†æ¬¡å¯åŠ¨es</p>
<ol start="2">
<li>
<h3 id="å®‰è£…skywalking">å®‰è£…skywalking</h3>
</li>
</ol>
<pre><code class="language-shell">docker run --name skywalking-oap-server --restart always -d --restart=always  -e TZ=Asia/Shanghai  -p 12800:12800  -p 11800:11800 --link es7:es7 -e SW_STORAGE=elasticsearch -e SW_STORAGE_ES_CLUSTER_NODES=es7:9200 apache/skywalking-oap-server:6.6.0-es7
</code></pre>
<p>æ¥ç€å®‰è£…ç®¡ç†ç•Œé¢</p>
<pre><code class="language-shell">docker run -d --name skywalking-ui  --restart=always  -e TZ=Asia/Shanghai  -p 8088:8080  --link skywalking:skywalking  -e SW_OAP_ADDRESS=skywalking:12800  apache/skywalking-ui:6.6.0  --security.user.admin.password=admin
</code></pre>
<p>ç„¶åé…ç½®ç«¯å£å¼€æ”¾</p>
<figure data-type="image" tabindex="1"><img src="https://zblzbl1991.github.io/post-images/1629862052220.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://zblzbl1991.github.io/post/hello-gridea/</id>
        <link href="https://zblzbl1991.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>